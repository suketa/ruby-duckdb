<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>class StackProf::Report - RDoc Documentation</title>

  <meta name="keywords" content="ruby,class,StackProf::Report">

    <meta name="description" content="Documentation for the StackProf::Report class">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="class">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
  
  <div id="parent-class-section" class="nav-section">
  <h3>Ancestors</h3>
  <ul><li><a href="../Object.html">Object</a><ul><li>BasicObject</li></ul></li></ul>
</div>

  
  
  
  <div class="nav-section">
    <h3>Class Methods</h3>
    <ul class="link-list" role="directory">
      <li ><a href="#method-c-from_file">from_file</a></li>
      <li ><a href="#method-c-from_json">from_json</a></li>
      <li ><a href="#method-c-new">new</a></li>
      <li ><a href="#method-c-parse_json">parse_json</a></li>
    </ul>
  </div>



  <div class="nav-section">
    <h3>Instance Methods</h3>
    <ul class="link-list" role="directory">
      <li ><a href="#method-i-2B">+</a></li>
      <li ><a href="#method-i-add_lines">add_lines</a></li>
      <li ><a href="#method-i-convert_to_d3_flame_graph_format">convert_to_d3_flame_graph_format</a></li>
      <li ><a href="#method-i-files">files</a></li>
      <li ><a href="#method-i-flamegraph_row">flamegraph_row</a></li>
      <li ><a href="#method-i-flamegraph_stacks">flamegraph_stacks</a></li>
      <li ><a href="#method-i-frames">frames</a></li>
      <li ><a href="#method-i-max_samples">max_samples</a></li>
      <li ><a href="#method-i-modeline">modeline</a></li>
      <li ><a href="#method-i-normalized_frames">normalized_frames</a></li>
      <li ><a href="#method-i-overall_samples">overall_samples</a></li>
      <li ><a href="#method-i-print_alphabetical_flamegraph">print_alphabetical_flamegraph</a></li>
      <li ><a href="#method-i-print_callgrind">print_callgrind</a></li>
      <li ><a href="#method-i-print_d3_flamegraph">print_d3_flamegraph</a></li>
      <li ><a href="#method-i-print_debug">print_debug</a></li>
      <li ><a href="#method-i-print_dump">print_dump</a></li>
      <li ><a href="#method-i-print_file">print_file</a></li>
      <li ><a href="#method-i-print_files">print_files</a></li>
      <li ><a href="#method-i-print_flamegraph">print_flamegraph</a></li>
      <li ><a href="#method-i-print_graphviz">print_graphviz</a></li>
      <li ><a href="#method-i-print_json">print_json</a></li>
      <li ><a href="#method-i-print_method">print_method</a></li>
      <li ><a href="#method-i-print_stackcollapse">print_stackcollapse</a></li>
      <li ><a href="#method-i-print_text">print_text</a></li>
      <li ><a href="#method-i-print_timeline_flamegraph">print_timeline_flamegraph</a></li>
      <li ><a href="#method-i-version">version</a></li>
      <li ><a href="#method-i-walk_method">walk_method</a></li>
    </ul>
  </div>



  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.10.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-labelledby="class-StackProf::Report">
  <h1 id="class-StackProf::Report" class="anchor-link class">
    class StackProf::Report
  </h1>

  <section class="description">
    
  </section>

  <section id="5Buntitled-5D" class="documentation-section anchor-link">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="MARSHAL_SIGNATURE">MARSHAL_SIGNATURE
        <dd>
          
      </dl>
    </section>

    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      <div id="attribute-i-data" class="method-detail anchor-link">
        <div class="method-heading attribute-method-heading">
          <a href="#attribute-i-data" title="Link to this attribute">
            <span class="method-name">data</span>
            <span class="attribute-access-type">[R]</span>
          </a>
        </div>

        <div class="method-description">
        
        </div>
      </div>
    </section>


     <section id="public-class-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-from_file" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-from_file" title="Link to this method">
                <span class="method-name">from_file</span>
                <span class="method-args">(file)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="from_file-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">from_file</span>(<span class="ruby-identifier">file</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">content</span> = <span class="ruby-constant">IO</span>.<span class="ruby-identifier">binread</span>(<span class="ruby-identifier">file</span>)).<span class="ruby-identifier">start_with?</span>(<span class="ruby-constant">MARSHAL_SIGNATURE</span>)
    <span class="ruby-identifier">new</span>(<span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">content</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">from_json</span>(<span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">content</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-c-from_json" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-from_json" title="Link to this method">
                <span class="method-name">from_json</span>
                <span class="method-args">(json)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="from_json-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 20</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">from_json</span>(<span class="ruby-identifier">json</span>)
  <span class="ruby-identifier">new</span>(<span class="ruby-identifier">parse_json</span>(<span class="ruby-identifier">json</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-c-new" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-new" title="Link to this method">
                <span class="method-name">new</span>
                <span class="method-args">(data)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">data</span>)
  <span class="ruby-ivar">@data</span> = <span class="ruby-identifier">data</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-c-parse_json" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-parse_json" title="Link to this method">
                <span class="method-name">parse_json</span>
                <span class="method-args">(json)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="parse_json-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">parse_json</span>(<span class="ruby-identifier">json</span>)
  <span class="ruby-identifier">json</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">json</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">from_json</span>(<span class="ruby-identifier">value</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)

    <span class="ruby-identifier">new_key</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">key</span>
    <span class="ruby-keyword">when</span> <span class="ruby-regexp">/\A[0-9]*\z/</span>
      <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_i</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_sym</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">json</span>[<span class="ruby-identifier">new_key</span>] = <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">json</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-2B" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-2B" title="Link to this method">
                <span class="method-name">+</span>
                <span class="method-args">(other)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="2B-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 618</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">+</span>(<span class="ruby-identifier">other</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;cannot combine #{other.class}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">class</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;cannot combine #{modeline} with #{other.modeline}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">modeline</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">modeline</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;cannot combine v#{version} with v#{other.version}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">version</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">version</span>

  <span class="ruby-identifier">f1</span>, <span class="ruby-identifier">f2</span> = <span class="ruby-identifier">normalized_frames</span>, <span class="ruby-identifier">other</span>.<span class="ruby-identifier">normalized_frames</span>
  <span class="ruby-identifier">frames</span> = (<span class="ruby-identifier">f1</span>.<span class="ruby-identifier">keys</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">f2</span>.<span class="ruby-identifier">keys</span>).<span class="ruby-identifier">uniq</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">f1</span>[<span class="ruby-identifier">id</span>].<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>] = <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>]
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>]
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-identifier">id</span>]
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:total_samples</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:total_samples</span>]
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:samples</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:samples</span>]
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:edges</span>]
        <span class="ruby-identifier">edges</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:edges</span>] <span class="ruby-operator">||=</span> {}
        <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:edges</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">edge</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">edges</span>[<span class="ruby-identifier">edge</span>] <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>
          <span class="ruby-identifier">edges</span>[<span class="ruby-identifier">edge</span>] <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:lines</span>]
        <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:lines</span>] <span class="ruby-operator">||=</span> {}
        <span class="ruby-identifier">f2</span>[<span class="ruby-identifier">id</span>][<span class="ruby-value">:lines</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
          <span class="ruby-identifier">lines</span>[<span class="ruby-identifier">line</span>] = <span class="ruby-identifier">add_lines</span>(<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">line</span>], <span class="ruby-identifier">weight</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id</span>] = <span class="ruby-identifier">f1</span>[<span class="ruby-identifier">id</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">d1</span>, <span class="ruby-identifier">d2</span> = <span class="ruby-identifier">data</span>, <span class="ruby-identifier">other</span>.<span class="ruby-identifier">data</span>
  <span class="ruby-identifier">data</span> = {
    <span class="ruby-value">version:</span> <span class="ruby-identifier">version</span>,
    <span class="ruby-value">mode:</span> <span class="ruby-identifier">d1</span>[<span class="ruby-value">:mode</span>],
    <span class="ruby-value">interval:</span> <span class="ruby-identifier">d1</span>[<span class="ruby-value">:interval</span>],
    <span class="ruby-value">samples:</span> <span class="ruby-identifier">d1</span>[<span class="ruby-value">:samples</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">d2</span>[<span class="ruby-value">:samples</span>],
    <span class="ruby-value">gc_samples:</span> <span class="ruby-identifier">d1</span>[<span class="ruby-value">:gc_samples</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">d2</span>[<span class="ruby-value">:gc_samples</span>],
    <span class="ruby-value">missed_samples:</span> <span class="ruby-identifier">d1</span>[<span class="ruby-value">:missed_samples</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">d2</span>[<span class="ruby-value">:missed_samples</span>],
    <span class="ruby-value">frames:</span> <span class="ruby-identifier">frames</span>
  }

  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-add_lines" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-add_lines" title="Link to this method">
                <span class="method-name">add_lines</span>
                <span class="method-args">(a, b)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="add_lines-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 92</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_lines</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">b</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">b</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">a</span><span class="ruby-operator">+</span><span class="ruby-identifier">b</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Integer</span>
  <span class="ruby-keyword">return</span> [ <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">b</span> ] <span class="ruby-keyword">if</span> <span class="ruby-identifier">b</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Integer</span>
  [ <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">b</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">b</span>[<span class="ruby-value">1</span>] ]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-convert_to_d3_flame_graph_format" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-convert_to_d3_flame_graph_format" title="Link to this method">
                <span class="method-name">convert_to_d3_flame_graph_format</span>
                <span class="method-args">(name, stacks, depth)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="convert_to_d3_flame_graph_format-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 212</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_to_d3_flame_graph_format</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">stacks</span>, <span class="ruby-identifier">depth</span>)
  <span class="ruby-identifier">weight</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">children</span> = []
  <span class="ruby-identifier">stacks</span>.<span class="ruby-identifier">chunk</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stack</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">depth</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
      <span class="ruby-value">:leaf</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">stack</span>[<span class="ruby-identifier">depth</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span>, <span class="ruby-identifier">child_stacks</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">val</span> <span class="ruby-operator">==</span> <span class="ruby-value">:leaf</span>
      <span class="ruby-identifier">child_stacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stack</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">weight</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">frame</span> = <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>][<span class="ruby-identifier">val</span>]
      <span class="ruby-identifier">child_name</span> = <span class="ruby-node">&quot;#{ frame[:name] } : #{ frame[:file] } : #{ frame[:line] }&quot;</span>
      <span class="ruby-identifier">child_data</span> = <span class="ruby-identifier">convert_to_d3_flame_graph_format</span>(<span class="ruby-identifier">child_name</span>, <span class="ruby-identifier">child_stacks</span>, <span class="ruby-identifier">depth</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
      <span class="ruby-identifier">weight</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">child_data</span>[<span class="ruby-string">&quot;value&quot;</span>]
      <span class="ruby-identifier">children</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">child_data</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  {
    <span class="ruby-string">&quot;name&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">name</span>,
    <span class="ruby-string">&quot;value&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">weight</span>,
    <span class="ruby-string">&quot;children&quot;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">children</span>,
  }
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-files" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-files" title="Link to this method">
                <span class="method-name">files</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="files-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 80</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">files</span>
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:files</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>].<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, (<span class="ruby-identifier">addr</span>, <span class="ruby-identifier">frame</span>)<span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">file</span> = <span class="ruby-identifier">frame</span>[<span class="ruby-value">:file</span>] <span class="ruby-keyword">and</span> <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">frame</span>[<span class="ruby-value">:lines</span>]
      <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">file</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
      <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">file</span>][<span class="ruby-identifier">line</span>] = <span class="ruby-identifier">add_lines</span>(<span class="ruby-identifier">hash</span>[<span class="ruby-identifier">file</span>][<span class="ruby-identifier">line</span>], <span class="ruby-identifier">weight</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-flamegraph_row" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-flamegraph_row" title="Link to this method">
                <span class="method-name">flamegraph_row</span>
                <span class="method-args">(f, x, y, weight, addr)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="flamegraph_row-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 205</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">flamegraph_row</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">weight</span>, <span class="ruby-identifier">addr</span>)
  <span class="ruby-identifier">frame</span> = <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>][<span class="ruby-identifier">addr</span>]
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">print</span> <span class="ruby-string">&#39;,&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rows_started</span>
  <span class="ruby-ivar">@rows_started</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">%{{&quot;x&quot;:#{x},&quot;y&quot;:#{y},&quot;width&quot;:#{weight},&quot;frame_id&quot;:#{addr},&quot;frame&quot;:#{frame[:name].dump},&quot;file&quot;:#{frame[:file].dump}}}</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-flamegraph_stacks" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-flamegraph_stacks" title="Link to this method">
                <span class="method-name">flamegraph_stacks</span>
                <span class="method-args">(raw)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="flamegraph_stacks-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">flamegraph_stacks</span>(<span class="ruby-identifier">raw</span>)
  <span class="ruby-identifier">stacks</span> = []
  <span class="ruby-identifier">max_x</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">max_y</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">idx</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">while</span> <span class="ruby-identifier">len</span> = <span class="ruby-identifier">raw</span>[<span class="ruby-identifier">idx</span>]
    <span class="ruby-identifier">idx</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">max_y</span> = <span class="ruby-identifier">len</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">len</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max_y</span>
    <span class="ruby-identifier">stack</span> = <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-identifier">idx</span>, <span class="ruby-identifier">len</span><span class="ruby-value">+1</span>)
    <span class="ruby-identifier">idx</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">len</span><span class="ruby-value">+1</span>
    <span class="ruby-identifier">stacks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">stack</span>
    <span class="ruby-identifier">max_x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">stacks</span>, <span class="ruby-identifier">max_x</span>, <span class="ruby-identifier">max_y</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-frames" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-frames" title="Link to this method">
                <span class="method-name">frames</span>
                <span class="method-args">(sort_by_total=false)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="frames-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">frames</span>(<span class="ruby-identifier">sort_by_total</span>=<span class="ruby-keyword">false</span>)
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:&quot;sorted_frames_#{sort_by_total}&quot;</span>] <span class="ruby-operator">||=</span>
    <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>].<span class="ruby-identifier">sort_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">iseq</span>, <span class="ruby-identifier">stats</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">stats</span>[<span class="ruby-identifier">sort_by_total</span> <span class="ruby-operator">?</span> <span class="ruby-value">:total_samples</span> <span class="ruby-operator">:</span> <span class="ruby-value">:samples</span>] }.<span class="ruby-identifier">inject</span>({}){<span class="ruby-operator">|</span><span class="ruby-identifier">h</span>, (<span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span>)<span class="ruby-operator">|</span> <span class="ruby-identifier">h</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>; <span class="ruby-identifier">h</span>}
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-max_samples" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-max_samples" title="Link to this method">
                <span class="method-name">max_samples</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="max_samples-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 76</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">max_samples</span>
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:max_samples</span>] <span class="ruby-operator">||=</span> <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>].<span class="ruby-identifier">values</span>.<span class="ruby-identifier">max_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span><span class="ruby-operator">|</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:samples</span>] }[<span class="ruby-value">:samples</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-modeline" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-modeline" title="Link to this method">
                <span class="method-name">modeline</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="modeline-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">modeline</span>
  <span class="ruby-node">&quot;#{@data[:mode]}(#{@data[:interval]})&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-normalized_frames" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-normalized_frames" title="Link to this method">
                <span class="method-name">normalized_frames</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="normalized_frames-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 52</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">normalized_frames</span>
  <span class="ruby-identifier">id2hash</span> = {}
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">id2hash</span>[<span class="ruby-identifier">frame</span>.<span class="ruby-identifier">to_s</span>] = <span class="ruby-identifier">info</span>[<span class="ruby-value">:hash</span>] = <span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA256</span>.<span class="ruby-identifier">hexdigest</span>(<span class="ruby-node">&quot;#{info[:name]}#{info[:file]}#{info[:line]}&quot;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:frames</span>].<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span>, (<span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span>)<span class="ruby-operator">|</span>
    <span class="ruby-identifier">info</span> = <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">id2hash</span>[<span class="ruby-identifier">frame</span>.<span class="ruby-identifier">to_s</span>]] = <span class="ruby-identifier">info</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>] = <span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>].<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>){ <span class="ruby-operator">|</span><span class="ruby-identifier">edges</span>, (<span class="ruby-identifier">edge</span>, <span class="ruby-identifier">weight</span>)<span class="ruby-operator">|</span> <span class="ruby-identifier">edges</span>[<span class="ruby-identifier">id2hash</span>[<span class="ruby-identifier">edge</span>.<span class="ruby-identifier">to_s</span>]] = <span class="ruby-identifier">weight</span>; <span class="ruby-identifier">edges</span> } <span class="ruby-keyword">if</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>]
    <span class="ruby-identifier">hash</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-overall_samples" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-overall_samples" title="Link to this method">
                <span class="method-name">overall_samples</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="overall_samples-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 72</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">overall_samples</span>
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:samples</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_alphabetical_flamegraph" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_alphabetical_flamegraph" title="Link to this method">
                <span class="method-name">print_alphabetical_flamegraph</span>
                <span class="method-args">(f=STDOUT, skip_common=true)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_alphabetical_flamegraph-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 128</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_alphabetical_flamegraph</span>(<span class="ruby-identifier">f</span>=<span class="ruby-constant">STDOUT</span>, <span class="ruby-identifier">skip_common</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">print_flamegraph</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">skip_common</span>, <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_callgrind" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_callgrind" title="Link to this method">
                <span class="method-name">print_callgrind</span>
                <span class="method-args">(f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_callgrind-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 495</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_callgrind</span>(<span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;version: 1&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;creator: stackprof&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;pid: 0&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;cmd: ruby&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;part: 1&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;desc: mode: #{modeline}&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;desc: missed: #{@data[:missed_samples]})&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;positions: line&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;events: Instructions&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;summary: #{@data[:samples]}&quot;</span>

  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">frames</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>, <span class="ruby-identifier">frame</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;fl=#{frame[:file]}&quot;</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;fn=#{frame[:name]}&quot;</span>
    <span class="ruby-identifier">frame</span>[<span class="ruby-value">:lines</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{line} #{weight.is_a?(Array) ? weight[1] : weight}&quot;</span>
    <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:lines</span>]
    <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">edge</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">oframe</span> = <span class="ruby-identifier">list</span>[<span class="ruby-identifier">edge</span>]
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;cfl=#{oframe[:file]}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">oframe</span>[<span class="ruby-value">:file</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:file</span>]
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;cfn=#{oframe[:name]}&quot;</span>
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;calls=#{weight} #{frame[:line] || 0}\n#{oframe[:line] || 0} #{weight}&quot;</span>
    <span class="ruby-keyword">end</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>]
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;totals: #{@data[:samples]}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_d3_flamegraph" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_d3_flamegraph" title="Link to this method">
                <span class="method-name">print_d3_flamegraph</span>
                <span class="method-args">(f=STDOUT, skip_common=true)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_d3_flamegraph-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 242</span>
    <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_d3_flamegraph</span>(<span class="ruby-identifier">f</span>=<span class="ruby-constant">STDOUT</span>, <span class="ruby-identifier">skip_common</span>=<span class="ruby-keyword">true</span>)
      <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;profile does not include raw samples (add `raw: true` to collecting StackProf.run)&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">raw</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value">:raw</span>]

      <span class="ruby-identifier">stacks</span>, <span class="ruby-operator">*</span> = <span class="ruby-identifier">flamegraph_stacks</span>(<span class="ruby-identifier">raw</span>)

      <span class="ruby-comment"># d3-flame-grpah supports only alphabetical flamegraph</span>
      <span class="ruby-identifier">stacks</span>.<span class="ruby-identifier">sort!</span>

      <span class="ruby-identifier">require</span> <span class="ruby-string">&quot;json&quot;</span>
      <span class="ruby-identifier">json</span> = <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-identifier">convert_to_d3_flame_graph_format</span>(<span class="ruby-string">&quot;&lt;root&gt;&quot;</span>, <span class="ruby-identifier">stacks</span>, <span class="ruby-value">0</span>), <span class="ruby-value">max_nesting:</span> <span class="ruby-keyword">false</span>)

      <span class="ruby-comment"># This html code is almost copied from d3-flame-graph sample code.</span>
      <span class="ruby-comment"># (Apache License 2.0)</span>
      <span class="ruby-comment"># https://github.com/spiermar/d3-flame-graph/blob/gh-pages/index.html</span>

      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">&lt;&lt;-END</span>
<span class="ruby-value">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
  &lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge&quot;&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;

    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.jsdelivr.net/gh/spiermar/d3-flame-graph@2.0.3/dist/d3-flamegraph.css&quot;&gt;

    &lt;style&gt;

    /* Space out content a bit */
    body {
      padding-top: 20px;
      padding-bottom: 20px;
    }

    /* Custom page header */
    .header {
      padding-bottom: 20px;
      padding-right: 15px;
      padding-left: 15px;
      border-bottom: 1px solid #e5e5e5;
    }

    /* Make the masthead heading the same height as the navigation */
    .header h3 {
      margin-top: 0;
      margin-bottom: 0;
      line-height: 40px;
    }

    /* Customize container */
    .container {
      max-width: 990px;
    }

    address {
      text-align: right;
    }
    &lt;/style&gt;

    &lt;title&gt;stackprof (mode: #{ data[:mode] })&lt;/title&gt;

    &lt;!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries --&gt;
    &lt;!--[if lt IE 9]&gt;
      &lt;script src=&quot;https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js&quot;&gt;&lt;/script&gt;
      &lt;script src=&quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js&quot;&gt;&lt;/script&gt;
    &lt;![endif]--&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div class=&quot;container&quot;&gt;
      &lt;div class=&quot;header clearfix&quot;&gt;
        &lt;nav&gt;
          &lt;div class=&quot;pull-right&quot;&gt;
            &lt;form class=&quot;form-inline&quot; id=&quot;form&quot;&gt;
              &lt;a class=&quot;btn&quot; href=&quot;javascript: resetZoom();&quot;&gt;Reset zoom&lt;/a&gt;
              &lt;a class=&quot;btn&quot; href=&quot;javascript: clear();&quot;&gt;Clear&lt;/a&gt;
              &lt;div class=&quot;form-group&quot;&gt;
                &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;term&quot;&gt;
              &lt;/div&gt;
              &lt;a class=&quot;btn btn-primary&quot; href=&quot;javascript: search();&quot;&gt;Search&lt;/a&gt;
            &lt;/form&gt;
          &lt;/div&gt;
        &lt;/nav&gt;
        &lt;h3 class=&quot;text-muted&quot;&gt;stackprof (mode: #{ data[:mode] })&lt;/h3&gt;
      &lt;/div&gt;
      &lt;div id=&quot;chart&quot;&gt;
      &lt;/div&gt;
      &lt;address&gt;
        powered by &lt;a href=&quot;https://github.com/spiermar/d3-flame-graph&quot;&gt;d3-flame-graph&lt;/a&gt;
      &lt;/address&gt;
      &lt;hr&gt;
      &lt;div id=&quot;details&quot;&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- D3.js --&gt;
    &lt;script src=&quot;https://d3js.org/d3.v4.min.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;

    &lt;!-- d3-tip --&gt;
    &lt;script type=&quot;text/javascript&quot; src=https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.min.js&gt;&lt;/script&gt;

    &lt;!-- d3-flamegraph --&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;https://cdn.jsdelivr.net/gh/spiermar/d3-flame-graph@2.0.3/dist/d3-flamegraph.min.js&quot;&gt;&lt;/script&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
    var flameGraph = d3.flamegraph()
      .width(960)
      .cellHeight(18)
      .transitionDuration(750)
      .minFrameSize(5)
      .transitionEase(d3.easeCubic)
      .sort(true)
      //Example to sort in reverse order
      //.sort(function(a,b){ return d3.descending(a.name, b.name);})
      .title(&quot;&quot;)
      .onClick(onClick)
      .differential(false)
      .selfValue(false);


    // Example on how to use custom tooltips using d3-tip.
    // var tip = d3.tip()
    //   .direction(&quot;s&quot;)
    //   .offset([8, 0])
    //   .attr(&#39;class&#39;, &#39;d3-flame-graph-tip&#39;)
    //   .html(function(d) { return &quot;name: &quot; + d.data.name + &quot;, value: &quot; + d.data.value; });

    // flameGraph.tooltip(tip);

    var details = document.getElementById(&quot;details&quot;);
    flameGraph.setDetailsElement(details);

    // Example on how to use custom labels
    // var label = function(d) {
    //  return &quot;name: &quot; + d.name + &quot;, value: &quot; + d.value;
    // }
    // flameGraph.label(label);

    // Example of how to set fixed chart height
    // flameGraph.height(540);

    d3.select(&quot;#chart&quot;)
        .datum(#{ json })
        .call(flameGraph);

    document.getElementById(&quot;form&quot;).addEventListener(&quot;submit&quot;, function(event){
      event.preventDefault();
      search();
    });

    function search() {
      var term = document.getElementById(&quot;term&quot;).value;
      flameGraph.search(term);
    }

    function clear() {
      document.getElementById(&#39;term&#39;).value = &#39;&#39;;
      flameGraph.clear();
    }

    function resetZoom() {
      flameGraph.resetZoom();
    }

    function onClick(d) {
      console.info(&quot;Clicked on &quot; + d.data.name);
    }
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</span><span class="ruby-identifier">      END</span>
    <span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_debug" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_debug" title="Link to this method">
                <span class="method-name">print_debug</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_debug-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_debug</span>
  <span class="ruby-identifier">pp</span> <span class="ruby-ivar">@data</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_dump" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_dump" title="Link to this method">
                <span class="method-name">print_dump</span>
                <span class="method-args">(f=STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_dump-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_dump</span>(<span class="ruby-identifier">f</span>=<span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-constant">Marshal</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-ivar">@data</span>.<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">k</span> <span class="ruby-operator">==</span> <span class="ruby-value">:files</span> })
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_file" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_file" title="Link to this method">
                <span class="method-name">print_file</span>
                <span class="method-args">(filter, f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_file-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 610</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_file</span>(<span class="ruby-identifier">filter</span>, <span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">filter</span> = <span class="ruby-regexp">/#{Regexp.escape filter}/</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Regexp</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">filter</span>
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">files</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">lines</span><span class="ruby-operator">|</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">filter</span> }
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">sort_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">vals</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">vals</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-value">0</span>){ <span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>, <span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sum</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">n</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">n</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">n</span>) } }.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">lines</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">source_display</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">file</span>, <span class="ruby-identifier">lines</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_files" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_files" title="Link to this method">
                <span class="method-name">print_files</span>
                <span class="method-args">(sort_by_total=false, limit=nil, f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_files-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 600</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_files</span>(<span class="ruby-identifier">sort_by_total</span>=<span class="ruby-keyword">false</span>, <span class="ruby-identifier">limit</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">files</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">vals</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">file</span>, <span class="ruby-identifier">vals</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">inject</span>([<span class="ruby-value">0</span>,<span class="ruby-value">0</span>]){ <span class="ruby-operator">|</span><span class="ruby-identifier">sum</span>, <span class="ruby-identifier">n</span><span class="ruby-operator">|</span> <span class="ruby-identifier">add_lines</span>(<span class="ruby-identifier">sum</span>, <span class="ruby-identifier">n</span>) }] }
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">list</span>.<span class="ruby-identifier">sort_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">samples</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">samples</span>[<span class="ruby-value">1</span>] }
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">list</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">limit</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span>, <span class="ruby-identifier">vals</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">total_samples</span>, <span class="ruby-identifier">samples</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">vals</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;% 5d  (%5.1f%%) / % 5d  (%5.1f%%)   %s\n&quot;</span>, <span class="ruby-identifier">total_samples</span>, (<span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">total_samples</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>), <span class="ruby-identifier">samples</span>, (<span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">samples</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>), <span class="ruby-identifier">file</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_flamegraph" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_flamegraph" title="Link to this method">
                <span class="method-name">print_flamegraph</span>
                <span class="method-args">(f, skip_common, alphabetical=false)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_flamegraph-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 132</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_flamegraph</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">skip_common</span>, <span class="ruby-identifier">alphabetical</span>=<span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;profile does not include raw samples (add `raw: true` to collecting StackProf.run)&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">raw</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value">:raw</span>]

  <span class="ruby-identifier">stacks</span>, <span class="ruby-identifier">max_x</span>, <span class="ruby-identifier">max_y</span> = <span class="ruby-identifier">flamegraph_stacks</span>(<span class="ruby-identifier">raw</span>)

  <span class="ruby-identifier">stacks</span>.<span class="ruby-identifier">sort!</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">alphabetical</span>

  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;flamegraph([&#39;</span>
  <span class="ruby-identifier">max_y</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">y</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">row_prev</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">row_width</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">x</span> = <span class="ruby-value">0</span>

    <span class="ruby-identifier">stacks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stack</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">weight</span> = <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">last</span>
      <span class="ruby-identifier">cell</span> = <span class="ruby-identifier">stack</span>[<span class="ruby-identifier">y</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">y</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">stack</span>.<span class="ruby-identifier">length</span><span class="ruby-value">-1</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">cell</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_prev</span>
          <span class="ruby-identifier">flamegraph_row</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">row_prev</span>)
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">row_prev</span> = <span class="ruby-keyword">nil</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_prev</span>.<span class="ruby-identifier">nil?</span>        <span class="ruby-comment"># start new row with this cell</span>
        <span class="ruby-identifier">row_width</span> = <span class="ruby-identifier">weight</span>
        <span class="ruby-identifier">row_prev</span> = <span class="ruby-identifier">cell</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>

      <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">row_prev</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cell</span>  <span class="ruby-comment"># grow current row along x-axis</span>
        <span class="ruby-identifier">row_width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>

      <span class="ruby-keyword">else</span>                    <span class="ruby-comment"># end current row and start new row</span>
        <span class="ruby-identifier">flamegraph_row</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">row_prev</span>)
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">weight</span>
        <span class="ruby-identifier">row_prev</span> = <span class="ruby-identifier">cell</span>
        <span class="ruby-identifier">row_width</span> = <span class="ruby-identifier">weight</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">row_prev</span> = <span class="ruby-identifier">cell</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">row_prev</span>
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">skip_common</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">row_width</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">max_x</span>

      <span class="ruby-identifier">flamegraph_row</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">row_width</span>, <span class="ruby-identifier">row_prev</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&#39;])&#39;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_graphviz" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_graphviz" title="Link to this method">
                <span class="method-name">print_graphviz</span>
                <span class="method-args">(options = {}, f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_graphviz-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 414</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_graphviz</span>(<span class="ruby-identifier">options</span> = {}, <span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">filter</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:filter</span>]
    <span class="ruby-identifier">mark_stack</span> = []
    <span class="ruby-identifier">list</span> = <span class="ruby-identifier">frames</span>(<span class="ruby-keyword">true</span>)
    <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>, <span class="ruby-identifier">frame</span><span class="ruby-operator">|</span> <span class="ruby-identifier">mark_stack</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">addr</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">=~</span> <span class="ruby-identifier">filter</span> }
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">addr</span> = <span class="ruby-identifier">mark_stack</span>.<span class="ruby-identifier">pop</span>
      <span class="ruby-identifier">frame</span> = <span class="ruby-identifier">list</span>[<span class="ruby-identifier">addr</span>]
      <span class="ruby-keyword">unless</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:marked</span>]
        <span class="ruby-identifier">mark_stack</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>].<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span> <span class="ruby-identifier">addr</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">list</span>[<span class="ruby-identifier">addr</span>][<span class="ruby-value">:total_samples</span>] <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">weight</span><span class="ruby-operator">*</span><span class="ruby-value">1.2</span> }.<span class="ruby-identifier">compact</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>]
        <span class="ruby-identifier">frame</span>[<span class="ruby-value">:marked</span>] = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">list</span> = <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>, <span class="ruby-identifier">frame</span><span class="ruby-operator">|</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:marked</span>] }
    <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>, <span class="ruby-identifier">frame</span><span class="ruby-operator">|</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">frame</span>[<span class="ruby-value">:edges</span>].<span class="ruby-identifier">delete_if</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">list</span>[<span class="ruby-identifier">k</span>].<span class="ruby-identifier">nil?</span> } }
    <span class="ruby-identifier">list</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">list</span> = <span class="ruby-identifier">frames</span>(<span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>


  <span class="ruby-identifier">limit</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:limit</span>]
  <span class="ruby-identifier">fraction</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:node_fraction</span>]

  <span class="ruby-identifier">included_nodes</span> = {}
  <span class="ruby-identifier">node_minimum</span> = <span class="ruby-identifier">fraction</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">fraction</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">overall_samples</span>).<span class="ruby-identifier">ceil</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>

  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;digraph profile {&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Legend [shape=box,fontsize=24,shape=plaintext,label=\&quot;&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;Total samples: #{overall_samples}\\l&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;Showing top #{limit} nodes\\l&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">print</span> <span class="ruby-node">&quot;Dropped nodes with &lt; #{node_minimum} samples\\l&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">fraction</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\&quot;];&quot;</span>

  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span>), <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">call</span>, <span class="ruby-identifier">total</span> = <span class="ruby-identifier">info</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">:samples</span>, <span class="ruby-value">:total_samples</span>)
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">total</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">node_minimum</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">limit</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">limit</span>)

    <span class="ruby-identifier">sample</span> = <span class="ruby-string">&#39;&#39;</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">sample</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{call} (%2.1f%%)\\rof &quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-identifier">call</span><span class="ruby-operator">*</span><span class="ruby-value">100.0</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">call</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">total</span>
    <span class="ruby-identifier">sample</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{total} (%2.1f%%)\\r&quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-identifier">total</span><span class="ruby-operator">*</span><span class="ruby-value">100.0</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>)
    <span class="ruby-identifier">fontsize</span> = (<span class="ruby-value">1.0</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">call</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">max_samples</span>) <span class="ruby-operator">*</span> <span class="ruby-value">28</span> <span class="ruby-operator">+</span> <span class="ruby-value">10</span>
    <span class="ruby-identifier">size</span> = (<span class="ruby-value">1.0</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">total</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">overall_samples</span>) <span class="ruby-operator">*</span> <span class="ruby-value">2.0</span> <span class="ruby-operator">+</span> <span class="ruby-value">0.5</span>

    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;  \&quot;#{frame}\&quot; [size=#{size}] [fontsize=#{fontsize}] [penwidth=\&quot;#{size}\&quot;] [shape=box] [label=\&quot;#{info[:name]}\\n#{sample}\&quot;];&quot;</span>
    <span class="ruby-identifier">included_nodes</span>[<span class="ruby-identifier">frame</span>] = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">included_nodes</span>[<span class="ruby-identifier">frame</span>]

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">edges</span> = <span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>]
      <span class="ruby-identifier">edges</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">edge</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">included_nodes</span>[<span class="ruby-identifier">edge</span>]

        <span class="ruby-identifier">size</span> = (<span class="ruby-value">1.0</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">weight</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">overall_samples</span>) <span class="ruby-operator">*</span> <span class="ruby-value">2.0</span> <span class="ruby-operator">+</span> <span class="ruby-value">0.5</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;  \&quot;#{frame}\&quot; -&gt; \&quot;#{edge}\&quot; [label=\&quot;#{weight}\&quot;] [weight=\&quot;#{weight}\&quot;] [penwidth=\&quot;#{size}\&quot;];&quot;</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;}&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_json" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_json" title="Link to this method">
                <span class="method-name">print_json</span>
                <span class="method-args">(f=STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_json-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_json</span>(<span class="ruby-identifier">f</span>=<span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">require</span> <span class="ruby-string">&quot;json&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">generate</span>(<span class="ruby-ivar">@data</span>, <span class="ruby-value">max_nesting:</span> <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_method" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_method" title="Link to this method">
                <span class="method-name">print_method</span>
                <span class="method-args">(name, f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_method-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 526</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_method</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">name</span> = <span class="ruby-regexp">/#{name}/</span> <span class="ruby-keyword">unless</span> <span class="ruby-constant">Regexp</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">name</span>
  <span class="ruby-identifier">frames</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">=~</span> <span class="ruby-identifier">name</span>
    <span class="ruby-identifier">file</span>, <span class="ruby-identifier">line</span> = <span class="ruby-identifier">info</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">:file</span>, <span class="ruby-value">:line</span>)
    <span class="ruby-identifier">line</span> <span class="ruby-operator">||=</span> <span class="ruby-value">1</span>

    <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">info</span>[<span class="ruby-value">:lines</span>]
    <span class="ruby-identifier">maxline</span> = <span class="ruby-identifier">lines</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">max</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">+</span> <span class="ruby-value">5</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;%s (%s:%d)\n&quot;</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>], <span class="ruby-identifier">file</span>, <span class="ruby-identifier">line</span>
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;  samples: % 5d self (%2.1f%%)  /  % 5d total (%2.1f%%)\n&quot;</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value">:samples</span>], <span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">info</span>[<span class="ruby-value">:samples</span>]<span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value">:total_samples</span>], <span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">info</span>[<span class="ruby-value">:total_samples</span>]<span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">callers</span> = <span class="ruby-identifier">callers_for</span>(<span class="ruby-identifier">frame</span>)).<span class="ruby-identifier">any?</span>
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;  callers:&quot;</span>
      <span class="ruby-identifier">callers</span> = <span class="ruby-identifier">callers</span>.<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:last</span>).<span class="ruby-identifier">reverse</span>
      <span class="ruby-identifier">callers</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;   % 5d  (% 8s)  %s\n&quot;</span>, <span class="ruby-identifier">weight</span>, <span class="ruby-string">&quot;%3.1f%%&quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">weight</span><span class="ruby-operator">/</span><span class="ruby-identifier">info</span>[<span class="ruby-value">:total_samples</span>]), <span class="ruby-identifier">name</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">callees</span> = <span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>]
      <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;  callees (%d total):\n&quot;</span>, <span class="ruby-identifier">info</span>[<span class="ruby-value">:total_samples</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">info</span>[<span class="ruby-value">:samples</span>]
      <span class="ruby-identifier">callees</span> = <span class="ruby-identifier">callees</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">data</span>[<span class="ruby-value">:frames</span>][<span class="ruby-identifier">k</span>][<span class="ruby-value">:name</span>], <span class="ruby-identifier">weight</span>] }.<span class="ruby-identifier">sort_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">v</span> }
      <span class="ruby-identifier">callees</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;   % 5d  (% 8s)  %s\n&quot;</span>, <span class="ruby-identifier">weight</span>, <span class="ruby-string">&quot;%3.1f%%&quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-identifier">weight</span><span class="ruby-operator">/</span>(<span class="ruby-identifier">info</span>[<span class="ruby-value">:total_samples</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">info</span>[<span class="ruby-value">:samples</span>])), <span class="ruby-identifier">name</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;  code:&quot;</span>
    <span class="ruby-identifier">source_display</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">file</span>, <span class="ruby-identifier">lines</span>, <span class="ruby-identifier">line</span><span class="ruby-value">-1</span><span class="ruby-operator">..</span><span class="ruby-identifier">maxline</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_stackcollapse" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_stackcollapse" title="Link to this method">
                <span class="method-name">print_stackcollapse</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_stackcollapse-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 112</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_stackcollapse</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;profile does not include raw samples (add `raw: true` to collecting StackProf.run)&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">raw</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value">:raw</span>]

  <span class="ruby-keyword">while</span> <span class="ruby-identifier">len</span> = <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">shift</span>
    <span class="ruby-identifier">frames</span> = <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">len</span>)
    <span class="ruby-identifier">weight</span> = <span class="ruby-identifier">raw</span>.<span class="ruby-identifier">shift</span>

    <span class="ruby-identifier">print</span> <span class="ruby-identifier">frames</span>.<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">data</span>[<span class="ruby-value">:frames</span>][<span class="ruby-identifier">a</span>][<span class="ruby-value">:name</span>] }.<span class="ruby-identifier">join</span>(<span class="ruby-string">&#39;;&#39;</span>)
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot; #{weight}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_text" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_text" title="Link to this method">
                <span class="method-name">print_text</span>
                <span class="method-args">(sort_by_total=false, limit=nil, select_files= nil, reject_files=nil, select_names=nil, reject_names=nil, f = STDOUT)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_text-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 476</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_text</span>(<span class="ruby-identifier">sort_by_total</span>=<span class="ruby-keyword">false</span>, <span class="ruby-identifier">limit</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">select_files</span>= <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">reject_files</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">select_names</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">reject_names</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">f</span> = <span class="ruby-constant">STDOUT</span>)
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;==================================&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-node">&quot;  Mode: #{modeline}\n&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-node">&quot;  Samples: #{@data[:samples]} (%.2f%% miss rate)\n&quot;</span>, <span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-ivar">@data</span>[<span class="ruby-value">:missed_samples</span>]<span class="ruby-operator">/</span>(<span class="ruby-ivar">@data</span>[<span class="ruby-value">:missed_samples</span>]<span class="ruby-operator">+</span><span class="ruby-ivar">@data</span>[<span class="ruby-value">:samples</span>])
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-node">&quot;  GC: #{@data[:gc_samples]} (%.2f%%)\n&quot;</span>, <span class="ruby-value">100.0</span><span class="ruby-operator">*</span><span class="ruby-ivar">@data</span>[<span class="ruby-value">:gc_samples</span>]<span class="ruby-operator">/</span><span class="ruby-ivar">@data</span>[<span class="ruby-value">:samples</span>]
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;==================================&quot;</span>
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;% 10s    (pct)  % 10s    (pct)     FRAME\n&quot;</span> <span class="ruby-operator">%</span> [<span class="ruby-string">&quot;TOTAL&quot;</span>, <span class="ruby-string">&quot;SAMPLES&quot;</span>]
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">frames</span>(<span class="ruby-identifier">sort_by_total</span>)
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> <span class="ruby-identifier">select_files</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:file</span>].<span class="ruby-identifier">start_with?</span>(<span class="ruby-identifier">path</span>)}} <span class="ruby-keyword">if</span> <span class="ruby-identifier">select_files</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">select!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> <span class="ruby-identifier">select_names</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">reg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">=~</span> <span class="ruby-identifier">reg</span>}} <span class="ruby-keyword">if</span> <span class="ruby-identifier">select_names</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">reject!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> <span class="ruby-identifier">reject_files</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">path</span><span class="ruby-operator">|</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:file</span>].<span class="ruby-identifier">start_with?</span>(<span class="ruby-identifier">path</span>)}} <span class="ruby-keyword">if</span> <span class="ruby-identifier">reject_files</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">reject!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> <span class="ruby-identifier">reject_names</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">reg</span><span class="ruby-operator">|</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">=~</span> <span class="ruby-identifier">reg</span>}} <span class="ruby-keyword">if</span> <span class="ruby-identifier">reject_names</span>
  <span class="ruby-identifier">list</span> = <span class="ruby-identifier">list</span>.<span class="ruby-identifier">first</span>(<span class="ruby-identifier">limit</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">limit</span>
  <span class="ruby-identifier">list</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">call</span>, <span class="ruby-identifier">total</span> = <span class="ruby-identifier">info</span>.<span class="ruby-identifier">values_at</span>(<span class="ruby-value">:samples</span>, <span class="ruby-value">:total_samples</span>)
    <span class="ruby-identifier">f</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;% 10d % 8s  % 10d % 8s     %s\n&quot;</span>, <span class="ruby-identifier">total</span>, <span class="ruby-string">&quot;(%2.1f%%)&quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-identifier">total</span><span class="ruby-operator">*</span><span class="ruby-value">100.0</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>), <span class="ruby-identifier">call</span>, <span class="ruby-string">&quot;(%2.1f%%)&quot;</span> <span class="ruby-operator">%</span> (<span class="ruby-identifier">call</span><span class="ruby-operator">*</span><span class="ruby-value">100.0</span><span class="ruby-operator">/</span><span class="ruby-identifier">overall_samples</span>), <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-print_timeline_flamegraph" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-print_timeline_flamegraph" title="Link to this method">
                <span class="method-name">print_timeline_flamegraph</span>
                <span class="method-args">(f=STDOUT, skip_common=true)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="print_timeline_flamegraph-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">print_timeline_flamegraph</span>(<span class="ruby-identifier">f</span>=<span class="ruby-constant">STDOUT</span>, <span class="ruby-identifier">skip_common</span>=<span class="ruby-keyword">true</span>)
  <span class="ruby-identifier">print_flamegraph</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">skip_common</span>, <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-version" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-version" title="Link to this method">
                <span class="method-name">version</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="version-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">version</span>
  <span class="ruby-ivar">@data</span>[<span class="ruby-value">:version</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-walk_method" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-walk_method" title="Link to this method">
                <span class="method-name">walk_method</span>
                <span class="method-args">(name)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="walk_method-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/stackprof-0.2.26/lib/stackprof/report.rb, line 561</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">walk_method</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-identifier">method_choice</span>  = <span class="ruby-regexp">/#{Regexp.escape name}/</span>
  <span class="ruby-identifier">invalid_choice</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-comment"># Continue walking up and down the stack until the users selects &quot;exit&quot;</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">method_choice</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:exit</span>
    <span class="ruby-identifier">print_method</span> <span class="ruby-identifier">method_choice</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">invalid_choice</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\n\n&quot;</span>

    <span class="ruby-comment"># Determine callers and callees for the current frame</span>
    <span class="ruby-identifier">new_frames</span>  = <span class="ruby-identifier">frames</span>.<span class="ruby-identifier">select</span>  {<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> <span class="ruby-identifier">info</span>[<span class="ruby-value">:name</span>] <span class="ruby-operator">=~</span> <span class="ruby-identifier">method_choice</span> }
    <span class="ruby-identifier">new_choices</span> = <span class="ruby-identifier">new_frames</span>.<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">frame</span>, <span class="ruby-identifier">info</span><span class="ruby-operator">|</span> [
      <span class="ruby-identifier">callers_for</span>(<span class="ruby-identifier">frame</span>).<span class="ruby-identifier">sort_by</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:last</span>).<span class="ruby-identifier">reverse</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first</span>),
      (<span class="ruby-identifier">info</span>[<span class="ruby-value">:edges</span>] <span class="ruby-operator">||</span> []).<span class="ruby-identifier">map</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">w</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">data</span>[<span class="ruby-value">:frames</span>][<span class="ruby-identifier">k</span>][<span class="ruby-value">:name</span>], <span class="ruby-identifier">w</span>] }.<span class="ruby-identifier">sort_by</span>{ <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-operator">-</span><span class="ruby-identifier">v</span> }.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:first</span>)
    ]}.<span class="ruby-identifier">flatten</span> <span class="ruby-operator">+</span> [<span class="ruby-value">:exit</span>]

    <span class="ruby-comment"># Print callers and callees for selection</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Select next method:&quot;</span>
    <span class="ruby-identifier">new_choices</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">method</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
      <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;%2d)  %s\n&quot;</span>, <span class="ruby-identifier">index</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">method</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Pick selection</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">printf</span> <span class="ruby-string">&quot;&gt; &quot;</span>
    <span class="ruby-identifier">selection</span> = <span class="ruby-constant">STDIN</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">chomp</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;\n\n\n&quot;</span>

    <span class="ruby-comment"># Determine if it was a valid choice</span>
    <span class="ruby-comment"># (if not, don&#39;t re-run .print_method)</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_choice</span> = <span class="ruby-identifier">new_choices</span>[<span class="ruby-identifier">selection</span>]
      <span class="ruby-identifier">invalid_choice</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">method_choice</span> = <span class="ruby-identifier">new_choice</span> <span class="ruby-operator">==</span> <span class="ruby-value">:exit</span> <span class="ruby-operator">?</span> <span class="ruby-value">:exit</span> <span class="ruby-operator">:</span> <span class="ruby-regexp">%r/^#{Regexp.escape new_choice}$/</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">invalid_choice</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-constant">STDOUT</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;Invalid choice.  Please select again...&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Walk up and down the stack from a given starting point (name).  Loops until :exit` is selected</p>
        </div>


      </div>

    </section>

  </section>
</main>

