<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>module Minitest::Spec::DSL - RDoc Documentation</title>

  <meta name="keywords" content="ruby,module,Minitest::Spec::DSL">

    <meta name="description" content="module Minitest::Spec::DSL: DSL module! Eat your heart out DHH.">

<script type="text/javascript">
  var rdoc_rel_prefix = "../../";
  var index_rel_prefix = "../../";
</script>

<script src="../../js/navigation.js" defer></script>
<script src="../../js/search.js" defer></script>
<script src="../../js/search_index.js" defer></script>
<script src="../../js/searcher.js" defer></script>
<script src="../../js/darkfish.js" defer></script>

<link href="../../css/fonts.css" rel="stylesheet">
<link href="../../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="module">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../table_of_contents.html#pages">Pages</a>
    <a href="../../table_of_contents.html#classes">Classes</a>
    <a href="../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
  
  
  
  
  


  <div class="nav-section">
    <h3>Instance Methods</h3>
    <ul class="link-list" role="directory">
      <li class="calls-super" ><a href="#method-i-after">after</a></li>
      <li class="calls-super" ><a href="#method-i-before">before</a></li>
      <li ><a href="#method-i-it">it</a></li>
      <li ><a href="#method-i-let">let</a></li>
      <li ><a href="#method-i-register_spec_type">register_spec_type</a></li>
      <li ><a href="#method-i-spec_type">spec_type</a></li>
      <li ><a href="#method-i-specify">specify</a></li>
      <li ><a href="#method-i-subject">subject</a></li>
    </ul>
  </div>



  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.10.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-labelledby="module-Minitest::Spec::DSL">
  <h1 id="module-Minitest::Spec::DSL" class="anchor-link module">
    module Minitest::Spec::DSL
  </h1>

  <section class="description">
    
<p>Oh look! <a href="../../A.html"><code>A</code></a> <a href="DSL.html"><code>Minitest::Spec::DSL</code></a> module! Eat your heart out DHH.</p>

  </section>

  <section id="5Buntitled-5D" class="documentation-section anchor-link">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="TYPES">TYPES
        <dd>
          <p>Contains pairs of matchers and <a href="../Spec.html"><code>Spec</code></a> classes to be used to calculate the superclass of a top-level describe. This allows for automatically customizable spec types.</p>

<p>See: <a href="DSL.html#method-i-register_spec_type"><code>register_spec_type</code></a> and <a href="DSL.html#method-i-spec_type"><code>spec_type</code></a></p>
      </dl>
    </section>



     <section id="public-instance-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-after" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-after" title="Link to this method">
                <span class="method-name">after</span>
                <span class="method-args">(_type = nil, &amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="after-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after</span> <span class="ruby-identifier">_type</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-value">:teardown</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
    <span class="ruby-keyword">super</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Define an ‘after’ action. Inherits the way normal methods should.</p>

<p>NOTE: <code>type</code> is ignored and is only there to make porting easier.</p>

<p>Equivalent to <a href="../Test/LifecycleHooks.html#method-i-teardown"><code>Minitest::Test#teardown</code></a>.</p>
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
        </div>


      </div>

      <div id="method-i-before" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-before" title="Link to this method">
                <span class="method-name">before</span>
                <span class="method-args">(_type = nil, &amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="before-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 192</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before</span> <span class="ruby-identifier">_type</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">define_method</span> <span class="ruby-value">:setup</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">super</span>()
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Define a ‘before’ action. Inherits the way normal methods should.</p>

<p>NOTE: <code>type</code> is ignored and is only there to make porting easier.</p>

<p>Equivalent to <a href="../Test/LifecycleHooks.html#method-i-setup"><code>Minitest::Test#setup</code></a>.</p>
            <div class="method-calls-super">
              Calls superclass method
              
            </div>
        </div>


      </div>

      <div id="method-i-it" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-it" title="Link to this method">
                <span class="method-name">it</span>
                <span class="method-args">(desc = &quot;anonymous&quot;, &amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="it-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 224</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">it</span> <span class="ruby-identifier">desc</span> = <span class="ruby-string">&quot;anonymous&quot;</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">block</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-identifier">skip</span> <span class="ruby-string">&quot;(no tests defined)&quot;</span> }

  <span class="ruby-ivar">@specs</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>
  <span class="ruby-ivar">@specs</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

  <span class="ruby-identifier">name</span> = <span class="ruby-string">&quot;test_%04d_%s&quot;</span> <span class="ruby-operator">%</span> [ <span class="ruby-ivar">@specs</span>, <span class="ruby-identifier">desc</span> ]

  <span class="ruby-identifier">undef_klasses</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">children</span>.<span class="ruby-identifier">reject</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">public_method_defined?</span> <span class="ruby-identifier">name</span> }

  <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>

  <span class="ruby-identifier">undef_klasses</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">undef_klass</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">undef_klass</span>.<span class="ruby-identifier">send</span> <span class="ruby-value">:undef_method</span>, <span class="ruby-identifier">name</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Define an expectation with name <code>desc</code>. Name gets morphed to a proper test method name. For some freakish reason, people who write specs don’t like class inheritance, so this goes way out of its way to make sure that expectations aren’t inherited.</p>

<p>This is also aliased to <a href="DSL.html#method-i-specify"><code>specify</code></a> and doesn’t require a <code>desc</code> arg.</p>

<p>Hint: If you <em>do</em> want inheritance, use minitest/test. You can mix and match between assertions and expectations as much as you want.</p>
        </div>

        <div class="aliases">
          Also aliased as: <a href="DSL.html#method-i-specify">specify</a>
        </div>

      </div>

      <div id="method-i-let" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-let" title="Link to this method">
                <span class="method-name">let</span>
                <span class="method-args">(name, &amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="let-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 248</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">let</span> <span class="ruby-identifier">name</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">pre</span>, <span class="ruby-identifier">post</span> = <span class="ruby-node">&quot;let &#39;#{name}&#39; cannot &quot;</span>, <span class="ruby-string">&quot;. Please use another name.&quot;</span>
  <span class="ruby-identifier">methods</span> = <span class="ruby-constant">Minitest</span><span class="ruby-operator">::</span><span class="ruby-constant">Spec</span>.<span class="ruby-identifier">instance_methods</span>.<span class="ruby-identifier">map</span>(<span class="ruby-operator">&amp;</span><span class="ruby-value">:to_s</span>) <span class="ruby-operator">-</span> <span class="ruby-node">%w[subject]</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;#{pre}begin with &#39;test&#39;#{post}&quot;</span> <span class="ruby-keyword">if</span>
    <span class="ruby-identifier">name</span>.<span class="ruby-identifier">start_with?</span> <span class="ruby-string">&quot;test&quot;</span>
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;#{pre}override a method in Minitest::Spec#{post}&quot;</span> <span class="ruby-keyword">if</span>
    <span class="ruby-identifier">methods</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">name</span>

  <span class="ruby-identifier">define_method</span> <span class="ruby-identifier">name</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@_memoized</span> <span class="ruby-operator">||=</span> {}
    <span class="ruby-ivar">@_memoized</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-identifier">name</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">k</span><span class="ruby-operator">|</span> <span class="ruby-ivar">@_memoized</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">instance_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Essentially, define an accessor for <code>name</code> with <code>block</code>.</p>

<p>Why use let instead of def? I honestly don’t know.</p>
        </div>


      </div>

      <div id="method-i-register_spec_type" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-register_spec_type" title="Link to this method">
                <span class="method-name">register_spec_type</span>
                <span class="method-args">(*args, &amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="register_spec_type-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 147</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">register_spec_type</span> <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword">then</span>
    <span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span> = <span class="ruby-identifier">block</span>, <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span> = <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">TYPES</span>.<span class="ruby-identifier">unshift</span> [<span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">klass</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Register a new type of spec that matches the spec’s description. This method can take either a Regexp and a spec class or a spec class and a block that takes the description and returns true if it matches.</p>

<p>Eg:</p>

<pre class="ruby"><span class="ruby-identifier">register_spec_type</span>(<span class="ruby-regexp">/Controller$/</span>, <span class="ruby-constant">Minitest</span><span class="ruby-operator">::</span><span class="ruby-constant">Spec</span><span class="ruby-operator">::</span><span class="ruby-constant">Rails</span>)
</pre>

<p>or:</p>

<pre class="ruby"><span class="ruby-identifier">register_spec_type</span>(<span class="ruby-constant">Minitest</span><span class="ruby-operator">::</span><span class="ruby-constant">Spec</span><span class="ruby-operator">::</span><span class="ruby-constant">RailsModel</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">desc</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">desc</span>.<span class="ruby-identifier">superclass</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>
<span class="ruby-keyword">end</span>
</pre>
        </div>


      </div>

      <div id="method-i-spec_type" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-spec_type" title="Link to this method">
                <span class="method-name">spec_type</span>
                <span class="method-args">(desc, *additional)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="spec_type-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">spec_type</span> <span class="ruby-identifier">desc</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">additional</span>
  <span class="ruby-constant">TYPES</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">matcher</span>, <span class="ruby-identifier">_klass</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">matcher</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:call</span> <span class="ruby-keyword">then</span>
      <span class="ruby-identifier">matcher</span>.<span class="ruby-identifier">call</span> <span class="ruby-identifier">desc</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">additional</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">matcher</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">desc</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>
  }.<span class="ruby-identifier">last</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Figure out the spec class to use based on a spec’s description. Eg:</p>

<pre class="ruby"><span class="ruby-identifier">spec_type</span>(<span class="ruby-string">&quot;BlahController&quot;</span>) <span class="ruby-comment"># =&gt; Minitest::Spec::Rails</span>
</pre>
        </div>


      </div>

      <div id="method-i-specify" class="method-detail anchor-link method-alias">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-specify" title="Link to this method">
                <span class="method-name">specify</span>
                <span class="method-args">(desc = &quot;anonymous&quot;, &amp;block)</span>
              </a>
            </div>
        </div>


        <div class="method-description">
          
        </div>


        <div class="aliases">
          Alias for: <a href="DSL.html#method-i-it">it</a>
        </div>
      </div>

      <div id="method-i-subject" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-subject" title="Link to this method">
                <span class="method-name">subject</span>
                <span class="method-args">(&amp;block)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="subject-source">
            <pre><span class="ruby-comment"># File vendor/bundle/ruby/3.4.0/gems/minitest-5.25.2/lib/minitest/spec.rb, line 267</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">subject</span> <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
  <span class="ruby-identifier">let</span> <span class="ruby-value">:subject</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>Another lazy man’s accessor generator. Made even more lazy by setting the name for you to <code>subject</code>.</p>
        </div>


      </div>

    </section>

  </section>
</main>

