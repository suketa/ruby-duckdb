<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>class DuckDB::PreparedStatement - RDoc Documentation</title>

  <meta name="keywords" content="ruby,class,DuckDB::PreparedStatement">

    <meta name="description" content="class DuckDB::PreparedStatement: PreparedStatement encapsulates connection with DuckDB prepared statement. Database.">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
  var index_rel_prefix = "../";
</script>

<script src="../js/navigation.js" defer></script>
<script src="../js/search.js" defer></script>
<script src="../js/search_index.js" defer></script>
<script src="../js/searcher.js" defer></script>
<script src="../js/darkfish.js" defer></script>

<link href="../css/fonts.css" rel="stylesheet">
<link href="../css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="class">
<div id="navigation-toggle" role="button" tabindex="0" aria-label="Toggle sidebar" aria-expanded="true" aria-controls="navigation">
  <span aria-hidden="true">&#9776;</span>
</div>


<nav id="navigation" role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../table_of_contents.html#pages">Pages</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search (/) for a class, method, ..." spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
  
  <div id="parent-class-section" class="nav-section">
  <h3>Ancestors</h3>
  <ul><li>Object</li></ul>
</div>

  
  
  
  <div class="nav-section">
    <h3>Class Methods</h3>
    <ul class="link-list" role="directory">
      <li ><a href="#method-c-new">new</a></li>
      <li ><a href="#method-c-prepare">prepare</a></li>
    </ul>
  </div>



  <div class="nav-section">
    <h3>Instance Methods</h3>
    <ul class="link-list" role="directory">
      <li ><a href="#method-i-bind">bind</a></li>
      <li ><a href="#method-i-bind_args">bind_args</a></li>
      <li ><a href="#method-i-bind_blob">bind_blob</a></li>
      <li ><a href="#method-i-bind_bool">bind_bool</a></li>
      <li ><a href="#method-i-bind_date">bind_date</a></li>
      <li ><a href="#method-i-bind_decimal">bind_decimal</a></li>
      <li ><a href="#method-i-bind_double">bind_double</a></li>
      <li ><a href="#method-i-bind_float">bind_float</a></li>
      <li ><a href="#method-i-bind_hugeint">bind_hugeint</a></li>
      <li ><a href="#method-i-bind_hugeint_internal">bind_hugeint_internal</a></li>
      <li ><a href="#method-i-bind_int16">bind_int16</a></li>
      <li ><a href="#method-i-bind_int32">bind_int32</a></li>
      <li ><a href="#method-i-bind_int64">bind_int64</a></li>
      <li ><a href="#method-i-bind_int8">bind_int8</a></li>
      <li ><a href="#method-i-bind_interval">bind_interval</a></li>
      <li ><a href="#method-i-bind_null">bind_null</a></li>
      <li ><a href="#method-i-bind_parameter_index">bind_parameter_index</a></li>
      <li ><a href="#method-i-bind_time">bind_time</a></li>
      <li ><a href="#method-i-bind_timestamp">bind_timestamp</a></li>
      <li ><a href="#method-i-bind_varchar">bind_varchar</a></li>
      <li ><a href="#method-i-clear_bindings">clear_bindings</a></li>
      <li ><a href="#method-i-execute">execute</a></li>
      <li ><a href="#method-i-nparams">nparams</a></li>
      <li ><a href="#method-i-param_type">param_type</a></li>
      <li ><a href="#method-i-parameter_name">parameter_name</a></li>
      <li ><a href="#method-i-pending_prepared">pending_prepared</a></li>
      <li ><a href="#method-i-pending_prepared_stream">pending_prepared_stream</a></li>
      <li ><a href="#method-i-statement_type">statement_type</a></li>
    </ul>
  </div>



  <footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.10.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

</nav>

<main role="main" aria-labelledby="class-DuckDB::PreparedStatement">
  <h1 id="class-DuckDB::PreparedStatement" class="anchor-link class">
    class DuckDB::PreparedStatement
  </h1>

  <section class="description">
    
<p>The <a href="PreparedStatement.html"><code>DuckDB::PreparedStatement</code></a> encapsulates connection with <a href="../DuckDB.html"><code>DuckDB</code></a> prepared statement.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name, email FROM users WHERE email = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&#39;email@example.com&#39;</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">execute</span>
</pre>

  </section>

  <section id="5Buntitled-5D" class="documentation-section anchor-link">


    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
        <dt id="RANGE_INT16">RANGE_INT16
        <dd>
          
        <dt id="RANGE_INT32">RANGE_INT32
        <dd>
          
        <dt id="RANGE_INT64">RANGE_INT64
        <dd>
          
      </dl>
    </section>



     <section id="public-class-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Class Methods</h3>
       </header>

      <div id="method-c-new" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-new" title="Link to this method">
                <span class="method-name">new</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="new-source">
            <pre>static VALUE duckdb_prepared_statement_initialize(VALUE self, VALUE con, VALUE query) {
    rubyDuckDBConnection *ctxcon;
    rubyDuckDBPreparedStatement *ctx;

    if (!rb_obj_is_kind_of(con, cDuckDBConnection)) {
        rb_raise(rb_eTypeError, &quot;1st argument should be instance of DackDB::Connection&quot;);
    }

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);
    ctxcon = get_struct_connection(con);

    if (duckdb_prepare(ctxcon-&gt;con, StringValuePtr(query), &amp;(ctx-&gt;prepared_statement)) == DuckDBError) {
        const char *error = duckdb_prepare_error(ctx-&gt;prepared_statement);
        rb_raise(eDuckDBError, &quot;%s&quot;, error ? error : &quot;Failed to prepare statement(Database connection closed?).&quot;);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-c-prepare" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-c-prepare" title="Link to this method">
                <span class="method-name">prepare</span>
                <span class="method-args">(con, sql) { |stmt| ... }</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="prepare-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 38</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">prepare</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
  <span class="ruby-identifier">stmt</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">stmt</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">stmt</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>return <a href="PreparedStatement.html"><code>DuckDB::PreparedStatement</code></a> object. The first argument is <a href="Connection.html"><code>DuckDB::Connection</code></a> object. The second argument is SQL string. If block is given, the block is executed and the statement is destroyed.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connection</span>
<span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">prepare</span>(<span class="ruby-identifier">con</span>, <span class="ruby-string">&#39;SELECT * FROM users WHERE id = ?&#39;</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">stmt</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-value">1</span>)
  <span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">execute</span>
<span class="ruby-keyword">end</span>
</pre>
        </div>


      </div>

    </section>

     <section id="public-instance-5Buntitled-5D-method-details" class="method-section anchor-link">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

      <div id="method-i-bind" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind" title="Link to this method">
                <span class="method-name">bind</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">index</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Integer</span>
    <span class="ruby-identifier">bind_with_index</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
    <span class="ruby-identifier">bind_with_name</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Symbol</span>
    <span class="ruby-identifier">bind_with_name</span>(<span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;1st argument `#{index}` must be Integer or String or Symbol.&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is the value of prepared statement parameter.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name, email FROM users WHERE email = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&#39;email@example.com&#39;</span>)
</pre>
        </div>


      </div>

      <div id="method-i-bind_args" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_args" title="Link to this method">
                <span class="method-name">bind_args</span>
                <span class="method-args">(*args, **kwargs)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_args-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_args</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>, <span class="ruby-operator">**</span><span class="ruby-identifier">kwargs</span>)
  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">each</span>.<span class="ruby-identifier">with_index</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">arg</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">bind</span>(<span class="ruby-identifier">i</span>, <span class="ruby-identifier">arg</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">kwargs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">bind</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds all parameters with SQL prepared statement.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE id = ?&#39;</span>
<span class="ruby-comment"># or</span>
<span class="ruby-comment"># sql =&#39;SELECT name FROM users WHERE id = $id&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind_args</span>([<span class="ruby-value">1</span>])
<span class="ruby-comment"># or</span>
<span class="ruby-comment"># stmt.bind_args(id: 1)</span>
</pre>
        </div>


      </div>

      <div id="method-i-bind_blob" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_blob" title="Link to this method">
                <span class="method-name">bind_blob</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_blob-source">
            <pre>static VALUE duckdb_prepared_statement_bind_blob(VALUE self, VALUE vidx, VALUE blob) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_blob(ctx-&gt;prepared_statement, idx, (const void *)StringValuePtr(blob), (idx_t)RSTRING_LEN(blob)) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_bool" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_bool" title="Link to this method">
                <span class="method-name">bind_bool</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_bool-source">
            <pre>static VALUE duckdb_prepared_statement_bind_bool(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);
    if (val != Qtrue &amp;&amp; val != Qfalse) {
        rb_raise(rb_eArgError, &quot;binding value must be boolean&quot;);
    }

    if (duckdb_bind_boolean(ctx-&gt;prepared_statement, idx, (val == Qtrue)) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_date" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_date" title="Link to this method">
                <span class="method-name">bind_date</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_date-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 159</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_date</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">date</span> = <span class="ruby-identifier">_parse_date</span>(<span class="ruby-identifier">value</span>)

  <span class="ruby-identifier">_bind_date</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">date</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">date</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">date</span>.<span class="ruby-identifier">day</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected date.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE birth_day = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>)
<span class="ruby-comment">#  or you can specify date string.</span>
<span class="ruby-comment"># stmt.bind(1, &#39;2021-02-23&#39;)</span>
</pre>
        </div>


      </div>

      <div id="method-i-bind_decimal" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_decimal" title="Link to this method">
                <span class="method-name">bind_decimal</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_decimal-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_decimal</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">decimal</span> = <span class="ruby-identifier">_parse_deciaml</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">lower</span>, <span class="ruby-identifier">upper</span> = <span class="ruby-identifier">decimal_to_hugeint</span>(<span class="ruby-identifier">decimal</span>)
  <span class="ruby-identifier">width</span> = <span class="ruby-identifier">decimal</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-string">&#39;F&#39;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/[^0-9]/</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">_bind_decimal</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">lower</span>, <span class="ruby-identifier">upper</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">decimal</span>.<span class="ruby-identifier">scale</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected BigDecimal value or any value that can be parsed into a BigDecimal.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT value FROM decimals WHERE decimal = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind_decimal</span>(<span class="ruby-value">1</span>, <span class="ruby-constant">BigDecimal</span>(<span class="ruby-string">&#39;987654.321&#39;</span>))
</pre>
        </div>


      </div>

      <div id="method-i-bind_double" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_double" title="Link to this method">
                <span class="method-name">bind_double</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_double-source">
            <pre>static VALUE duckdb_prepared_statement_bind_double(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    double dbl = NUM2DBL(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_double(ctx-&gt;prepared_statement, idx, dbl) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_float" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_float" title="Link to this method">
                <span class="method-name">bind_float</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_float-source">
            <pre>static VALUE duckdb_prepared_statement_bind_float(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    double dbl = NUM2DBL(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_float(ctx-&gt;prepared_statement, idx, (float)dbl) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_hugeint" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_hugeint" title="Link to this method">
                <span class="method-name">bind_hugeint</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_hugeint-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_hugeint</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">Integer</span>
    <span class="ruby-identifier">bind_varchar</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;2nd argument `#{value}` must be Integer.&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected Integer value. This method uses <a href="PreparedStatement.html#method-i-bind_varchar"><code>bind_varchar</code></a> internally.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE bigint_col = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind_hugeint</span>(<span class="ruby-value">1</span>, <span class="ruby-value">1_234_567_890_123_456_789_012_345</span>)
</pre>
        </div>


      </div>

      <div id="method-i-bind_hugeint_internal" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_hugeint_internal" title="Link to this method">
                <span class="method-name">bind_hugeint_internal</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_hugeint_internal-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_hugeint_internal</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">lower</span>, <span class="ruby-identifier">upper</span> = <span class="ruby-identifier">integer_to_hugeint</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">_bind_hugeint</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">lower</span>, <span class="ruby-identifier">upper</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value must be Integer value. This method uses duckdb_bind_hugeint internally.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE bigint_col = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind_hugeint_internal</span>(<span class="ruby-value">1</span>, <span class="ruby-value">1_234_567_890_123_456_789_012_345</span>)
</pre>
        </div>


      </div>

      <div id="method-i-bind_int16" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_int16" title="Link to this method">
                <span class="method-name">bind_int16</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_int16-source">
            <pre>static VALUE duckdb_prepared_statement_bind_int16(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    int16_t i16val = NUM2INT(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_int16(ctx-&gt;prepared_statement, idx, i16val) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_int32" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_int32" title="Link to this method">
                <span class="method-name">bind_int32</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_int32-source">
            <pre>static VALUE duckdb_prepared_statement_bind_int32(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    int32_t i32val = NUM2INT(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_int32(ctx-&gt;prepared_statement, idx, i32val) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_int64" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_int64" title="Link to this method">
                <span class="method-name">bind_int64</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_int64-source">
            <pre>static VALUE duckdb_prepared_statement_bind_int64(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    int64_t i64val = NUM2LL(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_int64(ctx-&gt;prepared_statement, idx, i64val) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_int8" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_int8" title="Link to this method">
                <span class="method-name">bind_int8</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_int8-source">
            <pre>static VALUE duckdb_prepared_statement_bind_int8(VALUE self, VALUE vidx, VALUE val) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);
    int8_t i8val = (int8_t)NUM2INT(val);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_int8(ctx-&gt;prepared_statement, idx, i8val) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_interval" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_interval" title="Link to this method">
                <span class="method-name">bind_interval</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_interval-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 214</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_interval</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">value</span> = <span class="ruby-constant">Interval</span>.<span class="ruby-identifier">to_interval</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">_bind_interval</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">interval_months</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">interval_days</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">interval_micros</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected ISO8601 time interval string.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT value FROM intervals WHERE interval = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&#39;P1Y2D&#39;</span>)
</pre>
        </div>


      </div>

      <div id="method-i-bind_null" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_null" title="Link to this method">
                <span class="method-name">bind_null</span>
                <span class="method-args">(p1)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_null-source">
            <pre>static VALUE duckdb_prepared_statement_bind_null(VALUE self, VALUE vidx) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_null(ctx-&gt;prepared_statement, idx) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_parameter_index" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_parameter_index" title="Link to this method">
                <span class="method-name">bind_parameter_index</span>
                <span class="method-args">(p1)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_parameter_index-source">
            <pre>static VALUE duckdb_prepared_statement_bind_parameter_index(VALUE self, VALUE name) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx;

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_parameter_index(ctx-&gt;prepared_statement, &amp;idx, StringValuePtr(name)) == DuckDBError) {;
        rb_raise(rb_eArgError, &quot;parameter &#39;%s&#39; not found&quot;, StringValuePtr(name));
    }
    return ULL2NUM(idx);
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-bind_time" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_time" title="Link to this method">
                <span class="method-name">bind_time</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_time-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 178</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_time</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">time</span> = <span class="ruby-identifier">_parse_time</span>(<span class="ruby-identifier">value</span>)

  <span class="ruby-identifier">_bind_time</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">hour</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">sec</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">usec</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected time value.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE birth_time = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>)
<span class="ruby-comment">#  or you can specify time string.</span>
<span class="ruby-comment"># stmt.bind(1, &#39;07:39:45&#39;)</span>
</pre>
        </div>


      </div>

      <div id="method-i-bind_timestamp" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_timestamp" title="Link to this method">
                <span class="method-name">bind_timestamp</span>
                <span class="method-args">(index, value)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_timestamp-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 197</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">bind_timestamp</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">value</span>)
  <span class="ruby-identifier">time</span> = <span class="ruby-identifier">_parse_time</span>(<span class="ruby-identifier">value</span>)

  <span class="ruby-identifier">_bind_timestamp</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">year</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">month</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">day</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">hour</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">min</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">sec</span>, <span class="ruby-identifier">time</span>.<span class="ruby-identifier">usec</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>binds i-th parameter with SQL prepared statement. The first argument is index of parameter. The index of first parameter is 1 not 0. The second argument value is to expected time value.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">&#39;duckdb_database&#39;</span>)
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">sql</span> =<span class="ruby-string">&#39;SELECT name FROM users WHERE created_at = ?&#39;</span>
<span class="ruby-identifier">stmt</span> = <span class="ruby-constant">PreparedStatement</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">con</span>, <span class="ruby-identifier">sql</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">bind</span>(<span class="ruby-value">1</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>)
<span class="ruby-comment">#  or you can specify timestamp string.</span>
<span class="ruby-comment"># stmt.bind(1, &#39;2022-02-23 07:39:45&#39;)</span>
</pre>
        </div>


      </div>

      <div id="method-i-bind_varchar" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-bind_varchar" title="Link to this method">
                <span class="method-name">bind_varchar</span>
                <span class="method-args">(p1, p2)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="bind_varchar-source">
            <pre>static VALUE duckdb_prepared_statement_bind_varchar(VALUE self, VALUE vidx, VALUE str) {
    rubyDuckDBPreparedStatement *ctx;
    idx_t idx = check_index(vidx);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_bind_varchar(ctx-&gt;prepared_statement, idx, StringValuePtr(str)) == DuckDBError) {
        rb_raise(eDuckDBError, &quot;fail to bind %llu parameter&quot;, (unsigned long long)idx);
    }
    return self;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-clear_bindings" class="method-detail anchor-link ">
        <div class="method-header">
              <div class="method-heading">
                <a href="#method-i-clear_bindings" title="Link to this method">
                  <span class="method-callseq">
                    clear_bindings &rarr; DuckDB::PreparedStatement
                  </span>
                </a>
              </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="clear_bindings-source">
            <pre>static VALUE duckdb_prepared_statement_clear_bindings(VALUE self) {
    rubyDuckDBPreparedStatement *ctx;
    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    if (duckdb_clear_bindings(ctx-&gt;prepared_statement) == DuckDBError) {
        const char *error = duckdb_prepare_error(ctx-&gt;prepared_statement);
        rb_raise(eDuckDBError, &quot;fail to clear bindings. %s&quot;, error);
    }
    return self;
}</pre>
          </div>
          <p>clear all bindings of prepared statement.</p>
        </div>


      </div>

      <div id="method-i-execute" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-execute" title="Link to this method">
                <span class="method-name">execute</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="execute-source">
            <pre>static VALUE duckdb_prepared_statement_execute(VALUE self) {
    rubyDuckDBPreparedStatement *ctx;
    rubyDuckDBResult *ctxr;
    const char *error;
    VALUE result = rbduckdb_create_result();

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);
    ctxr = get_struct_result(result);

    duckdb_prepared_statement_execute_nogvl_args args = {
        .prepared_statement = ctx-&gt;prepared_statement,
        .out_result = &amp;(ctxr-&gt;result),
        .retval = DuckDBError,
    };

    rb_thread_call_without_gvl((void *)duckdb_prepared_statement_execute_nogvl, &amp;args, RUBY_UBF_IO, 0);
    duckdb_state state = args.retval;

    if (state == DuckDBError) {
        error = duckdb_result_error(args.out_result);
        if (error == NULL) {
            error = duckdb_prepare_error(args.prepared_statement);
        }

        rb_raise(eDuckDBError, &quot;%s&quot;, error ? error : &quot;Failed to execute prepared statement.&quot;);
    }

    return result;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-nparams" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-nparams" title="Link to this method">
                <span class="method-name">nparams</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="nparams-source">
            <pre>static VALUE duckdb_prepared_statement_nparams(VALUE self) {
    rubyDuckDBPreparedStatement *ctx;
    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);
    return ULL2NUM(duckdb_nparams(ctx-&gt;prepared_statement));
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-param_type" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-param_type" title="Link to this method">
                <span class="method-name">param_type</span>
                <span class="method-args">(index)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="param_type-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">param_type</span>(<span class="ruby-identifier">index</span>)
  <span class="ruby-identifier">i</span> = <span class="ruby-identifier">_param_type</span>(<span class="ruby-identifier">index</span>)
  <span class="ruby-constant">Converter</span><span class="ruby-operator">::</span><span class="ruby-constant">IntToSym</span>.<span class="ruby-identifier">type_to_sym</span>(<span class="ruby-identifier">i</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>returns parameter type. The argument must be index of parameter.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;duckdb&#39;</span>
<span class="ruby-identifier">db</span> = <span class="ruby-constant">DuckDB</span><span class="ruby-operator">::</span><span class="ruby-constant">Database</span>.<span class="ruby-identifier">open</span>
<span class="ruby-identifier">con</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">connect</span>
<span class="ruby-identifier">con</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-string">&#39;CREATE TABLE users (id INTEGER, name VARCHAR(255))&#39;</span>)
<span class="ruby-identifier">stmt</span> = <span class="ruby-identifier">con</span>.<span class="ruby-identifier">prepared_statement</span>(<span class="ruby-string">&#39;SELECT * FROM users WHERE id = ?&#39;</span>)
<span class="ruby-identifier">stmt</span>.<span class="ruby-identifier">param_type</span>(<span class="ruby-value">1</span>) <span class="ruby-comment"># =&gt; :integer</span>
</pre>
        </div>


      </div>

      <div id="method-i-parameter_name" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-parameter_name" title="Link to this method">
                <span class="method-name">parameter_name</span>
                <span class="method-args">(p1)</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="parameter_name-source">
            <pre>static VALUE duckdb_prepared_statement_parameter_name(VALUE self, VALUE vidx) {
    rubyDuckDBPreparedStatement *ctx;
    VALUE vname;
    const char *name;
    idx_t idx = check_index(vidx);

    TypedData_Get_Struct(self, rubyDuckDBPreparedStatement, &amp;prepared_statement_data_type, ctx);

    name = duckdb_parameter_name(ctx-&gt;prepared_statement, idx);
    if (name == NULL) {
        rb_raise(eDuckDBError, &quot;fail to get name of %llu parameter&quot;, (unsigned long long)idx);
    }
    vname = rb_str_new2(name);
    duckdb_free((void *)name);
    return vname;
}</pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-pending_prepared" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-pending_prepared" title="Link to this method">
                <span class="method-name">pending_prepared</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="pending_prepared-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pending_prepared</span>
  <span class="ruby-constant">PendingResult</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-pending_prepared_stream" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-pending_prepared_stream" title="Link to this method">
                <span class="method-name">pending_prepared_stream</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="pending_prepared_stream-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">pending_prepared_stream</span>
  <span class="ruby-constant">PendingResult</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, <span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>


      </div>

      <div id="method-i-statement_type" class="method-detail anchor-link ">
        <div class="method-header">
            <div class="method-heading">
              <a href="#method-i-statement_type" title="Link to this method">
                <span class="method-name">statement_type</span>
                <span class="method-args">()</span>
              </a>
            </div>
        </div>

          <div class="method-controls">
            <details class="method-source-toggle">
              <summary>Source</summary>
            </details>
          </div>

        <div class="method-description">
          <div class="method-source-code" id="statement_type-source">
            <pre><span class="ruby-comment"># File lib/duckdb/prepared_statement.rb, line 69</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">statement_type</span>
  <span class="ruby-identifier">i</span> = <span class="ruby-identifier">_statement_type</span>
  <span class="ruby-constant">Converter</span><span class="ruby-operator">::</span><span class="ruby-constant">IntToSym</span>.<span class="ruby-identifier">statement_type_to_sym</span>(<span class="ruby-identifier">i</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          <p>returns statement type. The return value is one of the following symbols:</p>

<pre>:invalid, :select, :insert, :update, :explain, :delete, :prepare, :create,
:execute, :alter, :transaction, :copy, :analyze, :variable_set, :create_func,
:drop, :export, :pragma, :vacuum, :call, :set, :load, :relation, :extension,
:logical_plan, :attach, :detach, :multi

 require &#39;duckdb&#39;
 db = DuckDB::Database.open(&#39;duckdb_database&#39;)
 con = db.connect
 stmt = con.prepared_statement(&#39;SELECT * FROM users&#39;)
 stmt.statement_type # =&gt; :select</pre>
        </div>


      </div>

    </section>

  </section>
</main>

